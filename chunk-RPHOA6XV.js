import{f as n,g as i,ha as g,i as a,n as p,q as c,x as d}from"./chunk-L62VYAUM.js";var D=(()=>{class r{get persons(){return this._persons.asReadonly()}constructor(){this.dataUrl="./assets/persons.json",this.http=c(g),this._persons=d([]),this.loadInitialData()}loadInitialData(){let t=sessionStorage.getItem("persons");t?this._persons.set(JSON.parse(t)):this.http.get(this.dataUrl).subscribe(s=>{this.updateSessionStorage(s)})}getPersons(){let t=sessionStorage.getItem("persons");if(t){let s=JSON.parse(t);return this._persons.set(s),n(s)}else return this.http.get(this.dataUrl).pipe(i(s=>(this.updateSessionStorage(s),s)),a(s=>(console.error(s),n([]))))}addPerson(t){let s=sessionStorage.getItem("persons");if(s){let e=JSON.parse(s);e.push(t),this.updateSessionStorage(e)}}getPerson(t){let s=sessionStorage.getItem("persons");if(s){let o=JSON.parse(s).find(h=>h.id===t);return n(o)}return n()}deletePerson(t){let s=sessionStorage.getItem("persons");if(s){let e=JSON.parse(s);for(let o=0;o<e.length;o++)e[o].id==t&&e.splice(o,1);this.updateSessionStorage(e)}}updatePerson(t){let s=sessionStorage.getItem("persons");if(s){let e=JSON.parse(s);for(let o=0;o<e.length;o++)e[o].id==t.id&&(e[o]=t);this.updateSessionStorage(e)}}updateSessionStorage(t){sessionStorage.setItem("persons",JSON.stringify(t)),this._persons.set(t)}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{D as a};
